## 一、开端

### 1.1. 总览

```C++
//选自 https://www.cnblogs.com/shuqin/p/12214439.html
spdlog
    ├─example  用法代码
    ├─include  实现目录
    │  └─spdlog
    │      ├─details  功能函数目录
    │      ├─fmt  {fmt} 库目录
    │      ├─sinks  落地文件格式实现
    │      └─*.h    异步模式，日志库接口等实现
    ├─src  .cpp 文件，组成编译模块生成静态库使用
    ├─test  测试代码
```

别人化的类图([spdlog源码分析-整体框架_spdlog架构_注定会的博客-CSDN博客](https://blog.csdn.net/csenjoy/article/details/96337751?spm=1001.2014.3001.5502))：

<img src="https://img-blog.csdnimg.cn/20190717194316356.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NzZW5qb3k=,size_16,color_FFFFFF,t_70" alt="img" style="zoom:150%;" />

### 1.2. level

日志的级别在`include\spdlog\common.h`中，由枚举`level_enum`给出。由低到高为`trace debug info warn err critical off`。**默认级别为info(define SPDLOG_ACTIVE_LEVEL SPDLOG_LEVEL_INFO)**

相关主要函数有`to_string_view`和`from_str`，功能分别为根据枚举获取字符串和根据字符串获取枚举值。

这些内容都在`namespace level`中



## 二、example

这节简单看一下example。

**几点发现：**

1. 支持格式化、多线程、异步、多输出目标、计时、自定义类型格式化、自定义异常信息处理等功能
2. **spdlog::[info/warn/...]**使用的是默认的logger作为输出
3. **spdlog::xxx_xxx_[mt/st]**为自己新建logger时用的api。

下阶段目标是看懂默认的输出(以info为例)。

输出一条日志的过程大致为：`spdlog::info -> details::registry中的默认logger.info -> 构造details::log_msg -> logger::log_it_ -> 该logger的所有sink.log`

看起来要先弄清 details::log_msg和sink。







